# 10月14日 上课错误记录

## module3() 函数目的

实现一个用户登录系统：
1. 预设4个用户的账号和密码
2. 用户输入账号
3. 如果账号存在，提示输入密码
4. 密码最多可以尝试3次
5. 密码正确则登录成功，3次全错则登录失败
6. 如果账号不存在，提示错误

## 原始错误代码

```c
void module3()
{
	//第一个维度[4] 代表可以保存几个字符串 
	//第二个维度[10] 代表每个字符串可以容纳几个字符 
	char username[4][10] = {"admin","user1","user2","user3"};
	char password[4][10] = {"123456","qwerty","000000","111111"};
	
	//读入数组
	char inputUser[10] = {0};
	char inputPass[10] = {0};
	
	int pw_error = 0;
	int un_error = 0; 
	int i;
	
	printf("请输入账号:\n");
	scanf("%s",inputUser);
	
	for(i = 0;i < 3; i++)
	{	
		if(!strcmp(username[i],inputUser))
		{
			un_error++;
			if(un_error >= 3)
			{
				printf("账号或密码错误，请重试！\n");
				break;
			} 
			continue;	
		}
	    else if(strcmp(username[i],inputUser) == 0)
		{	
			while(pw_error <= 3)
			{
				printf("请输入密码:\n");
				scanf("%s",inputPass);
				
				if(strcmp(password[i],inputPass) == 0)
				{
					printf("登陆成功...\n");
					break;	
				}
				else
				{
					pw_error++;
					printf("账号或密码错误，你还有%d次机会！\n",3-pw_error); 		
				}
			}
		}		
		else
		{
			if(pw_error > 3)
			{
				printf("账号或密码错误，请重试！\n");
			}
		}
		break;
	}
}
```

## ⚠️ 最严重的错误：条件判断矛盾

### 错误代码位置
```c
if(!strcmp(username[i],inputUser))          // 第一个条件
{
    un_error++;
    continue;	
}
else if(strcmp(username[i],inputUser) == 0)  // 第二个条件
{	
    // 密码验证逻辑
}
```

### 错误原因

**`strcmp()` 函数的返回值：**
- 返回 `0`：两个字符串**相等**
- 返回非0：两个字符串**不相等**

**条件判断分析：**

1. **第一个条件** `if(!strcmp(username[i],inputUser))`
   - 当 `strcmp()` 返回 0（字符串相等）
   - `!0` = `1`（真）
   - 所以这个条件表示：**字符串相等时执行**

2. **第二个条件** `else if(strcmp(username[i],inputUser) == 0)`
   - `strcmp() == 0` 也表示：**字符串相等**

### 问题所在

**两个条件判断的是完全相同的情况！**

- 当用户名匹配时，进入第一个if分支，执行了错误处理（`un_error++`），然后continue
- 第二个else if永远不会执行（因为第一个if已经处理了相等的情况）
- 密码验证的代码永远无法执行！

### 导致的现象

输入账号后，如果账号存在：
1. 匹配成功
2. 进入第一个if（本应该是"不匹配"的逻辑）
3. `un_error++`，然后continue
4. 循环继续，最后break退出
5. 程序结束，没有提示输入密码

**本来应该进入密码验证的逻辑，却被错误的条件判断拦截了！**

### 正确的写法应该是

```c
// 方式1：使用 == 0 判断相等
if(strcmp(username[i], inputUser) == 0)  // 相等
{
    // 密码验证逻辑
}

// 方式2：使用 ! 判断相等
if(!strcmp(username[i], inputUser))  // 相等
{
    // 密码验证逻辑
}

// 方式3：使用 != 0 判断不相等
if(strcmp(username[i], inputUser) != 0)  // 不相等
{
    // 继续查找
}
```

## 其他次要错误

1. **循环范围错误**：`for(i = 0; i < 3; i++)` 应该是 `i < 4`（数组有4个元素）
2. **循环末尾的break**：导致只检查第一个用户就退出循环
3. **密码验证条件**：`while(pw_error <= 3)` 会允许4次尝试，应该是 `pw_error < 3`

## 教训总结

⭐ **使用strcmp()时要特别注意：**
- `strcmp() == 0` 或 `!strcmp()` 表示**相等**
- `strcmp() != 0` 或 `strcmp()` 表示**不相等**

不要把相同的条件写在if和else if中，这样第二个分支永远不会执行！

